<!DOCTYPE html>
<html >
  <head>
    <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=.6, minimum-scale=.6">
<!--    <meta name="viewport" content="width=device-width,minimum-scale=1">-->

    <title>Multi-skill learning</title>

    <!--Favicon-->
<!--    <link rel="icon" type="../image/png" href="../img/favicon.png">-->
    <!--CSS Links-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Heebo:light">
    <link rel="preconnect" href="https://fonts.bunny.net">
    <link href="https://fonts.bunny.net/css?family=adamina:400" rel="stylesheet" />
    <style>
      a {
        text-decoration: none;
        color: #007ed3;
      }
      a:hover {
        color: #000000FF;
        border-bottom: 1px solid #000000FF;
      }

      .inline-list {
        display: flex;
        flex-wrap: wrap;
      }

      .inline-list dt,
      .inline-list dd {
        margin-right: 10px;
      }

      .videoWrapper iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      .pageOverview {
        position: fixed;
        top: 0;
        left: 0;
        width: 15%;
        max-width: 350px;
        background-color: #f1f1f1;
        padding: 20px;
        height: 100vh;
        overflow-y: auto;
        z-index: 2;
      }

      #pageOverview ul {
        list-style-type: none;
        padding: 0;
      }

      #pageOverview li {
        margin-bottom: 10px;
      }

      #pageOverview a {
        text-decoration: none;
      }

      #pageOverview .sub-menu {
        display: none;
        padding-left: 10px;
      }

      #pageOverview li:hover .sub-menu {
        display: block;
      }


      header {
        background-color: #f1f1f1;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

  .mainpage {
      margin-left: 20%;
      padding: 3%;
      max-width: 1200px;
      align-content: center;
      overflow-y: auto;
      font-family: 'Adamina', serif
    }

  .mobile-menu {
    display: none;
  }

  @media (max-width: 1300px) {
    .desktop-menu {
      display: none;
  }

  .mobile-menu {
    display: block;
    padding: 10px;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 65px;
    background-color: #f1f1f1;
    z-index: 2;
  }

  .dropdown {
    position: relative;
    display: inline-block;
  }

  .dropbtn {
    background-color: inherit;
    color: #000;
    /*padding: 10px;*/
    font-size: 16px;
    border: none;
    cursor: pointer;
  }
  .dropbtn:hover{
    background: #f9f9f9;
  }

  .dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 2;
  }

  .dropdown-content a {
    color: #007ed3;
    padding: 12px ;
    text-decoration: none;
    display: block;
  }

  .dropdown:hover .dropdown-content {
    display: block;
  }

  .pageOverview {
    display: none;
    width: 0;
  }

  .mainpage {
    margin-top: 70px;
    margin-left: 0;
    padding: 5%;
    align-content: center;
    overflow-y: auto;
    font-family: 'Adamina', serif
  }
}


    </style>
    <!--Scripts-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
  </head>

  <body>
  <header>

    <nav class="mobile-menu">
      <div style="display: flex; align-items: center; justify-content: center;">
        <dl class="inline-list" style="width: 20%; font-size: 14px; margin-right: auto; min-width: fit-content">
          <dt>
            <dl class="inline-list" style="width: 100%; font-size: 14px; margin-right: auto">
            <div class="dropdown">
            <button class="dropbtn" style="justify-content: left; align-items: center"><img src="media/menu.png" style="width: 100%; max-width: 50px; padding: inherit"></button>
            <div class="dropdown-content">
            <ul style="list-style-type: none; padding: 10px;overflow-y: auto;">
<!--              <li><a href="#Abstract">Abstract</a></li>-->
<!--              <li><a href="#Task">Task Description</a></li>-->
              <li><a href="#Methodology">How it works</a></li>
                    <ul class="sub-menu">
                      <li><a href="#Space state">Space State</a></li>
                    </ul>
                    <ul class="sub-menu">
                      <li><a href="#ISO">Initial State Optimisation</a></li>
                    </ul>
                    <ul class="sub-menu">
                      <li><a href="#B&P">Bootstrapping and Parallelization</a></li>
                    </ul>
              <li><a href="#Pre">Target Following Task</a></li>
              <li><a href="#Conclusion">Conclusion</a></li>
            </ul>
            </div>
            </div>
            </dl>
          </dt>
          <dt style="min-width: fit-content;">
          <div>
            <a href="https://cs.vu.nl/ci/" target="_blank" style="color: #8c8484; border-bottom: None">
            <img src="media/Logo_VU.png" alt="VU logo" style="width: 150px; padding-left: 2%"></a>
          </div>
          </dt>
        </dl>
        <dl class="inline-list" style="width: 80%; font-size: 14px; margin-right: 0; margin-left: auto; margin-top: -9px">
          <dd style="margin-left: auto">
          <div class="date">
            <div class="month" style="color: #8c8484"><a href="https://doi.org/10.1038/s41467-024-50131-4" target="_blank" style="color: #8c8484">Nature Communications<br>25-7-2024</a></div>
<!--            <div class="year" style="color: #8c8484">2024</div>-->
          </div>
          </dd>
          <dd style="border-left: 1px solid; color: #8c8484; padding-left: 1%;">
          <div class="date">
            <div class="year" style="color: #8c8484"><a href="https://github.com/fudavd/multi-skill-learning/tree/main/" target="_blank" style="color: #8c8484">Github<br>Code</a></div>
          </div>
          </dd>
<!--          <dd style="border-left: 1px solid; color: #8c8484; padding-left: 1%;">-->
<!--          <div class="date">-->
<!--            <div class="year" style="color: #8c8484"><a href="https://doi.org/10.21203/rs.3.rs-3062745/v1" target="_blank" style="color: #8c8484">Arxiv<br>PrePrint</a> </div>-->
<!--          </div>-->
<!--          </dd>-->
          <dd style="border-left: 1px solid; color: #8c8484; padding-left: 1%;">
          <div class="date">
            <div class="year" style="color: #8c8484;"><a href="https://youtu.be/zW7QQ42Pa9s" target="_blank" style="color: #8c8484">YouTube<br>Video</a>
            </div>
          </div>
          </dd>
        </dl>
        </div>
      </div>
    </nav>
  </header>


    <div class="pageOverview">
        <div>
          <a href="https://cs.vu.nl/ci/" target="_blank" style="color: #8c8484; border-bottom: None" >
          <img src="media/Logo_VU.png" width="100%" alt="VU logo" style="padding: 10px; max-width: 300px"></a>
        </div>
        <hr>
        <ul style="list-style-type: none; padding: 10px;overflow-y: auto;">
<!--          <li><a href="#Abstract">Abstract</a></li>-->
<!--          <li><a href="#Task">Task Description</a></li>-->
          <li><a href="#Methodology">How it works</a></li>
                <ul class="sub-menu">
                  <li><a href="#Space state">Space State</a></li>
                </ul>
                <ul class="sub-menu">
                  <li><a href="#ISO">Initial State Optimisation</a></li>
                </ul>
                <ul class="sub-menu">
                  <li><a href="#B&P">Bootstrapping and Parallelization</a></li>
                </ul>
          <li><a href="#Pre">Target Following Task</a></li>
          <li><a href="#Conclusion">Conclusion</a></li>
        </ul>
    </div>

    <div class="mainpage">
      <div class="row">
        <hr>
          <div class="page-header">
            <div>
              <h1 style="text-align: center; font-size: 56px;">A model-free method to learn multiple skills in parallel on modular robots</h1>
            </div>
          </div>
        <hr><br>

        <div id="subheader" style="display: flex; align-items: center; justify-content: center;">
        <dl id="mobile-content" class="inline-list" style="width: 100%; font-size: 14px; margin-right: auto; min-width: fit-content">
          <dt>
          <div class="date">
            <div class="month" style="color: #8c8484"><a href="https://orcid.org/0000-0002-7972-1649" target="_blank" style="color: #8c8484">Fuda van Diggelen</a></div>
            <div class="year" style="color: #8c8484"><a href="https://cs.vu.nl/ci/index.php/fuda-van-diggelen/" target="_blank" style="color: #8c8484">VU Amsterdam</a></div>
          </div>
          </dt>
          <dt>
          <div class="date">
            <div class="month" style="color: #8c8484"><a href="https://orcid.org/0000-0002-1165-286X" target="_blank" style="color: #8c8484">Nicolas Cambier</a></div>
            <div class="year" style="color: #8c8484"><a href="https://cs.vu.nl/ci/index.php/nicolas-cambier/" target="_blank" style="color: #8c8484">VU Amsterdam</a></div>
          </div>
          </dt>
          <dt>
          <div class="date">
            <div class="month" style="color: #8c8484"><a href="https://orcid.org/0000-0002-2213-8356" target="_blank" style="color: #8c8484">Eliseo Ferrante</a></div>
            <div class="year" style="color: #8c8484"><a href="https://cs.vu.nl/ci/index.php/dr-eliseo-ferrante/" target="_blank" style="color: #8c8484">VU Amsterdam</a></div>
          </div>
          </dt>
          <dt>
          <div class="date">
            <div class="month" style="color: #8c8484"><a href="https://orcid.org/0000-0002-3106-4213" target="_blank" style="color: #8c8484">A.E. Eiben</a></div>
            <div class="year" style="color: #8c8484"><a href="https://cs.vu.nl/ci/index.php/prof-dr-guszti-eiben/" target="_blank" style="color: #8c8484">VU Amsterdam</a></div>
          </div>
          </dt>
        </dl>
        <dl id="desktop-content" class="inline-list" style="width: 100%; font-size: 14px; margin-right: 0; margin-left: auto;">
          <dd style="margin-left: auto">
          <div class="date">
            <div class="month" style="color: #8c8484"><a href="https://doi.org/10.1038/s41467-024-50131-4" target="_blank" style="color: #8c8484">Nature Communications<br>25-7-2024</a></div>
<!--            <div class="year" style="color: #8c8484">2024</div>-->
          </div>
          </dd>
          <dd style="border-left: 1px solid; color: #8c8484; padding-left: 1%;">
          <div class="date">
<!--            <div class="month" style="color: #8c8484">Github</div>-->
            <div class="year" style="color: #8c8484"><a href="https://github.com/fudavd/multi-skill-learning/tree/main/" target="_blank" style="color: #8c8484">Github<br>Code</a></div>
          </div>
          </dd>
<!--          <dd style="border-left: 1px solid; color: #8c8484; padding-left: 1%;">-->
<!--          <div class="date">-->
<!--&lt;!&ndash;            <div class="month" style="color: #8c8484">Paper</div>&ndash;&gt;-->
<!--&lt;!&ndash;            <div class="year" style="color: #8c8484"><a href="https://doi.org/10.21203/rs.3.rs-3062745/v1" target="_blank" style="color: #8c8484">Arxiv<br>PrePrint</a> </div>&ndash;&gt;-->
<!--          </div>-->
<!--          </dd>-->
          <dd style="border-left: 1px solid; color: #8c8484; padding-left: 1%;">
          <div class="date">
            <div class="year" style="color: #8c8484;"><a href="https://youtu.be/zW7QQ42Pa9s" target="_blank" style="color: #8c8484">YouTube<br>Video</a>
            </div>
          </div>
          </dd>
        </dl>
        </div>
      </div>
      <br><br><br><br>
      <div style="text-align: center;align-items: center;">
          <b style="font-size: 30px; margin-bottom: 10px;">
            Three locomotion skills were learned in parallel under 15 minutes in the real world.
          </b>
      </div>
      <div>
          <br>
          <video playsinline autoplay muted loop style="width: 100%; border: 0px solid transparent">
            <source src="media/8998-9821.mp4" type="video/mp4"></source>
          </video>
        </div>

      <br><br>
      <br><br>

<!--        <div style="text-align: center;">-->
<!--          <h2 id="Abstract">Abstract</h2>-->
<!--        <p style="font-size: 16px; text-align: justify; margin-left: 12.5%; margin-right: 12.5%">-->
<!--          Legged robots are well-suited for deployment in unstructured environments through the use of 'limbs'. This results in a large range of robot morphologies, with various strengths, but each requiring a unique control scheme. As controllers optimized in simulation do not transfer well to the real world (the infamous sim-to-real gap), methods enabling quick learning in the real world, without any assumptions on the specific robot model and its dynamics, are necessary. In this paper, we present a generic method based on Central Pattern Generators (CPGs), that enables the acquisition of multiple basic locomotion skills in parallel, through very few trials. The novelty of our approach, underpinned by a mathematical analysis of the CPG model, is to search for good initial states, instead of optimizing connection weights. Empirical validation on six different robot morphologies demonstrates that our method enables robots to learn primary locomotion skills within fifteen minutes in the real world.-->
<!--        </p>-->
<!--        </div>-->
<!--        <br>-->
<!--        <br>-->
<!--        <br>-->

        <div style="text-align: justify; margin-bottom: 20px;">
<!--          <h2 id="Tasks">Task description</h2><hr>-->
          <p style="font-size: 16px; text-align: center; margin-left: 2%; margin-right: 2%">
            Locomotion is a pre-requisite for complex behaviour in mobile robots (like foraging, and scanning the environment).
              Being able to learn locomotion skills quickly is therefore a must when we deploy robots in unseen environments.
              When we lack a proper model of the world and of the robot, we need a model-free approach.
              In nature, many newborn animals can walk within minutes of birth.
              Central Pattern Generating neural networks (CPGs) can coordinate movement effectively without the need for extensive learning and neural adaptation.
              These neural centres, located in the spinal cord, can encode different behaviours that are started when higher level commands from the brain initialize the corresponding neurons. &nbsp;
              Drawing inspiration from this phenomenon, we propose a novel method that enables robots to learn locomotion in just 15 minutes.
          </p><p style="font-size: 16px;">
            In this work, 6 modular robots of various design are tasked to learn three locomotion skills from scratch with a training budget of 15 minutes in the real world.
            The skills are defined as follows:
          </p>
          <ul>
            <li style="text-align: justify; font-size: 16px; margin-left: 2%;  margin-bottom: 10px;">
              <b class="term">Gait (→)</b>: Maximizing planar displacement from starting position in a fixed time-interval
            </li>
            <li style="text-align: justify; font-size: 16px; margin-left: 2%;">
              <b class="term">Clockwise-</b> and <b class="term">Anti-clockwise Rotation (⟳/⟲)</b>: Maximizing planar rotation in a fixed time-interval.
            </li>
          </ul>
        </div>
        <div style="margin-bottom: 70px;">
          <p style="font-size: 16px;">
            Our modular robots are either hand-designed (top row of picture below) or a product of automated design using Evolutionary Computing (bottom row).
          </p>
          <div style="text-align: center; display: flex; justify-content: center; align-items: center;">
            <figure>
              <img src="media/robots/ant.png" alt="ant" style="margin-left: 3%; margin-right: 3%; width: 90%;">
              <figcaption>Ant</figcaption>
            </figure>
            <figure>
              <img src="media/robots/gecko.png" alt="gecko" style="margin-left: 3%; margin-right: 3%; width: 90%;">
              <figcaption>Gecko</figcaption>
            </figure>
            <figure>
              <img src="media/robots/spider.png" alt="spider" style="margin-left: 3%; margin-right: 3%; width: 90%;">
              <figcaption>Spider</figcaption>
            </figure>
          </div>
          <div style="text-align: center; display: flex; align-items: center; justify-content: center;">
            <figure>
              <img src="media/robots/blokky.png" alt="blokky" style="margin-left: 3%; margin-right: 3%; width: 90%;">
              <figcaption>Blokky</figcaption>
            </figure>
            <figure>
              <img src="media/robots/salamander.png" alt="salamander" style="margin-left: 3%; margin-right: 3%; width: 90%;">
              <figcaption>Salamander</figcaption>
            </figure>
            <figure>
              <img src="media/robots/stingray.png" alt="stingray" style="margin-left: 3%; margin-right: 3%; width: 90%;">
              <figcaption>Stingray</figcaption>
            </figure>
          </div>
        </div>

        <div style="text-align: justify; margin-bottom: 20px;">
          <hr><h2 id="Methodology">How it works</h2><hr>
          <p style="font-size: 16px; text-indent: 4%">
            CPGs are pairs of artificial neurons that reciprocally inhibit and excite each other to produce oscillatory behaviour, and can be described mathematically as a set of Ordinary Differential Equations as shown below.
            Originally, CPGs were used to describe the behaviour of groups of neuron responsible for generating locomotion patterns found in the spinal cords of several animals.
            In the last decade, CPGs have become increasingly more popular in robotics as a form of bio-inspired control due to their functional smoothness and cyclical behaviour.
          </p>
        </div>
        <div style="text-align: center; margin-bottom: 50px; font-size: 80%">
            <img src="media/CPG.svg" width="10%" alt="single cpg" style="margin-left: 3%; margin-right: 3%; min-width: 75px;">
            \(
          \Large\begin{align}
          % \begin{split}
              &\dot{x} = w_{yx}y \\
              &\dot{y} = w_{xy}x \\
          % \end{split}
            \end{align}
          \hspace{2em}
          \begin{split}
                  \begin{bmatrix}
                  \dot{x}\\
                  \dot{y}\\
                  \end{bmatrix} & = \begin{bmatrix}
                  0 & w_{yx} \\
                  w_{xy} & 0 \\
                  \end{bmatrix} \begin{bmatrix}
                  x\\
                  y\\
                  \end{bmatrix}
          \end{split}
          \)
        </div>
        <div style="text-align: justify; margin-bottom: 50px; display: flex; align-items: center; justify-content: center;">
          <p style="font-size: 16px;">
            We create a network of CPGs by coupling several oscillators with each other, based on the morphological design of a modular robot (depicted below as a blueprint).
            Here, each servomotor gets assigned a single CPG-oscillator that is subsequently linked to its neighbours, according to their modular-based distance as shown below.
            The final CPG-network is able to produce more complex signals which are correlated with neighbouring oscillators.
            The state-value of each \(x\)-neuron is sent as a position command to the corresponding robot's joints
          </p>
        </div>
        <div style="text-align: center; margin-bottom: 20px;">
            <img src="media/gecko_real.jpg" width="20%" alt="gecko blueprint" style="margin-left: 2%; margin-right: 3%;">
            <img src="media/gecko_blueprint.png" width="20%" alt="gecko blueprint" style="margin-left: 3%; margin-right: 3%;">
            <img src="media/gecko_blueprint_cpg2.png" width="22.5%" alt="gecko blueprint cpg" style="margin-left: 3%;"><br>
            <img src="media/CPG-network_clean.svg" width="30%" alt="cpg network" style="margin-bottom: 40px;">
          <p style="text-align: justify; font-size: 16px; margin-bottom: 40px;">
            Although some details may vary, our work shows that in essence the oscillatory behaviour within the CPG-network is invariably defined in terms of the connectivity between neurons and their initial state.
            As a result we can identify two modes of optimisation: 1) Weight optimisation (WO), which is a standard way of optimizing CPGs; and 2) Initial State optimisation (ISO), which (to our knowledge) has never been investigated.
            Our paper provides a thorough insight to the difference between WO and ISO and their mathematical properties.
            Here, we provide a quick insight to develop enough intuition to understand why ISO works.
          </p>
        </div>
        <div style="margin-bottom: 20px; margin-top: 40px;">
            <hr><h3 id="Space state" >State-space</h3><hr>
            <p style="text-align: justify; font-size: 16px; text-indent: 4%">
              If we look at the state-value of each neuron in our CPG-network, as time progresses, we can find (semi-)cyclical pattens emerge.
              Below, we map the state-value of two neurons on a 2D-plane to show the behaviour of the CPGs in their so-called 'state-space' (i.e. the bottom right plot).
              Keep in mind that the actual state-space of this particular CPG-network contains 12-dimensions, but for now 2-dimensions suffice for interpretation.
            </p>
          </div>
          <div style="margin-bottom: -3%; display: flex; align-items: center; justify-content: center;">
            <img src="media/CPG-network.svg" width="25%" alt="cpg-network">
            <br>
            <video playsinline autoplay muted loop style="width: 20%; transform: rotate(90deg); margin-left: -3%; margin-right: 2%; z-index: 1">
            <source src="media/neuron21.mp4" type="video/webm">
            </video>
            <br>
          </div>
          <div style="display: flex; align-items: center; justify-content: center;">
            <br>
            <video playsinline autoplay muted loop style="width: 20%">
              <source src="media/neuron11.mp4" type="video/webm">
            </video>
            <video playsinline autoplay muted loop style="width: 25%">
              <source src="media/state-space.mp4" type="video/webm">
            </video>
          </div>
          <br>

          <p style="text-align: justify; font-size: 16px;">
            The state-space trajectory is defined by the local derivatives of our CPG-network at any point in state-space.
            We can show this as a vector field in state-space, where each vector indicates the local derivative at the corresponding point in state-space.
            Now recall that the dynamics of the CPGs are solely defined by the weights in the network.
            This means that when we change the weights -as is done during WO- we are only changing the vector field in state-space, i.e. the local derivatives.
            A clear depiction of what happens when weights are changed is shown below.
          </p>
         <div style="text-align: center; display: flex; justify-content: center; align-items: center; margin-bottom: 20px; font-size: 13px;">
            \(
              \begin{equation}
              \begin{split}
              \begin{bmatrix}
              \dot{x}_1\\
              \dot{y}_1\\
              \dot{x}_2\\
              \dot{y}_2\\
              \vdots\\
              \end{bmatrix} & = \begin{bmatrix}
              0 & w_{y_1x_1}  & w_{x_2x_1} & 0 & \ldots\\
              w_{x_1y_1}  & 0 & 0 & 0 & \ldots\\
              w_{x_1x_2} & 0 & 0 & w_{y_2x_2}  & \ldots\\
              0  & 0 & w_{x_2y_2} & 0 & \ldots \\
              \vdots & \vdots & \vdots & \vdots & \ddots\\
              \end{bmatrix} \begin{bmatrix}
              x_1\\
              y_1\\
              x_2\\
              y_2\\
              \vdots\\
              \end{bmatrix}\\
              \end{split}
              \end{equation}
            \hspace{2em}
            \)
            <figure >
              <img src="media/vector_field_traj.svg" alt="cpg network" style="margin-left: 3%; margin-right: 3%; width: 100%; min-width: 200px">
              <figcaption>Vector field in state-space with corresponding trajectory</figcaption>
            </figure>
          </div>
          <div style="text-align: center; display: flex; justify-content: center; align-items: center; margin-bottom: 4%;">
            <figure>
              <figcaption>Weights 1</figcaption>
              <img src="media/network_dyn1_traj.svg" alt="WO1" style="margin-left: 3%; margin-right: 3%; width: 80%;">
            </figure>
            <figure>
              <figcaption>Weights 2</figcaption>
              <img src="media/network_dyn2_traj.svg" alt="WO2" style="margin-left: 3%; margin-right: 3%; width: 80%;">
            </figure>
            <figure >
              <figcaption>Weights 3</figcaption>
              <img src="media/network_dyn3_traj.svg" alt="WO3" style="margin-left: 3%; margin-right: 3%; width: 80%;">
            </figure>
          </div>

          <div style="margin-top: 40px; margin-bottom: 20px;">
            <hr><h3 id="ISO" >Initial State Optimisation</h3><hr>
            <p style="text-align: justify; font-size: 16px; text-indent: 4%">
              WO changes network dynamics (i.e. the vector field in state-space) which in return re-defines the behaviour of the CPGs.
              ISO keeps the network dynamics the same and 'selects' the proper behaviour through its initial position. Meaning we freeze the weights of the CPGs and optimises the initial start in state-space.
              Thus, in ISO the vector field remains the same, but we search for optimal CPG behaviour by testing different initial states.
              We like to view this as the CPG-network containing a 'reservoir' of (good) behaviours (encoded by its weights) and our initial state providing an 'input signal' to our network to select one of these behaviours.
            </p>
          </div>

          <div style="text-align: center; display: inline-block; justify-content: center; align-items: center; width: 100%;">
            <figure style="z-index: 2; display: inline-block;">
              <figcaption>Initial state sampling in state-space</figcaption>
              <img src="media/ISO_samples.svg" alt="cpg network" style="width: 84%;">
            </figure>
          </div>
          <div style="text-align: center; display: flex; justify-content: center; align-items: center; margin-bottom: 20px; margin-top: -10%; ">
            <figure style="z-index: -1;">
              <img src="media/initial1_traj.svg" alt="ISO1" style="margin-left: 3%; margin-right: 3%; width: 80%;">
              <figcaption>Initial State 1</figcaption>
            </figure>
            <figure style="z-index: -1;">
              <img src="media/initial2_traj.svg" alt="ISO2" style="margin-left: 3%; margin-right: 3%; width: 80%;">
              <figcaption>Initial State 2</figcaption>
            </figure>
            <figure style="z-index: -1;">
              <img src="media/initial3_traj.svg" alt="ISO3" style="margin-left: 3%; margin-right: 3%; width: 80%;">
              <figcaption>Initial State 3</figcaption>
            </figure>
          </div>
          <div style="text-align: center;">
            <p style="text-align: justify; font-size: 16px; margin-bottom: 30px;">
              Now we load our CPG-network on the real robot, where we test our sampled initial state.
              During a single trial, we save the intermediate states of the network (\(\mathcal{S}\)).
              In addition, an overhead system tracks the movement of our robot in the real world to collect position and orientation data (\(\mathcal{D}\)).
              In the end, we match the real world position and orientation data with the CPG-states at each respective time-stamp (\([0,1, \dots, N]\)).
            </p>
          </div>
          <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
            <img src="media/record_states.svg" alt="record_states" style="margin-left: 3%; margin-right: 3%; width: 40%;">
            <img src="media/record_robot.svg" alt="record_robot" style="margin-left: 3%; margin-right: 3%; width: 40%; margin-top: -2%;">
          </div>
          <div style="margin-top: 40px; margin-bottom: 20px">
            <hr><h3 id="B&P" >Bootstrapping and Parallelization</h3><hr>
            <p style="text-align: justify; font-size: 16px; text-indent: 4%;  margin-bottom: 10px;">
              ISO optimisation approaches the CPG-network as a reservoir of behaviours encoded by frozen weights.
              This means that optimisation <span style="text-decoration: underline;">does not affect</span> the network dynamics (the vector field remains the same).
              We can use this to our advantage with the following two tricks:
            </p>
            <ul>
              <li style="text-align: justify; font-size: 16px; margin-left: 5%;  margin-bottom: 10px;">
                <b class="term">Bootstrapping</b>: The intermediate CPG-network states from \(\mathcal{S}\) can be considered as additional possible initial state samples.
                This increases the amount of samples that we get \(N\) times, we assess the performance of a state at each time-step instead of assessing only one.
                The longer a trial lasts, the more bootstrapped samples we obtain.

              </li>
              <li style="text-align: justify; font-size: 16px; margin-left: 5%;  margin-bottom: 20px;">
                <b class="term">Parallelization</b>: The behavioural performance can be assessed on \(\mathcal{D}\) for multiple skills at once, instead of evaluating a single skill metric.
                Optimization of specific skills do not interfere when the dynamics of the CPG-network are frozen.
                This allows information to flow between learning tasks as can extract useful information among all skills at once.
              </li>
            </ul>
          </div>
          <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
            <img src="media/2tricks.svg" alt="2tricks" style="margin-left: 3%; margin-right: 3%; width: 30%;">
            <figure style="margin-left: 3%; margin-right: 5%; align-items: center; justify-content: center; width: 20%;">
              <figcaption style="font-family: monospace; font-size: 100%">Trial fitness:</figcaption>
              <img src="media/alg.svg" alt="alg" style="width: 100%">
            </figure>
          </div>

          <div style="text-align: center; margin-bottom: 40px;">
            <p style="text-align: justify; font-size: 16px; margin-bottom: 30px;">
              A trade-off can be made between testing longer to obtain more bootstrapped samples, or sampling different regions in state space with more trials (see Appendix for hyperparameter sweep of ISO).
              In our work, we choose to test 5 different regions for two minutes each (10 minutes in total) using random search.
              In the end, we select the best overall (intermediate) initial state sample for each skill (denoted as [\(s^*_{⟲}\), \(s^*_{→}\), \(s^*_{⟳}\)]).
            </p>
          </div>

          <div style="text-align: center; display: inline-block; justify-content: center; align-items: center; width: 100%; margin-bottom: 20px;">
            <figure style="display: inline-block;">
              <figcaption>Final skills encoded in the network:</figcaption>
              <img src="media/final_skills.svg" alt="alg" style="width: 80%">
            </figure>
          </div>

          <div style="text-align: justify; margin-bottom: 20px; margin-top: 40px">
<!--            <h2 id="Results">Results</h2>-->
            <p style="font-size: 16px;">
              In the end, we re-test our best initial states [\(s^*_{⟲}\), \(s^*_{→}\), \(s^*_{⟳}\)] to measure the performance of our ISO algorithm's final skills. The resulting behaviours are shown below.
            </p>
            <div style="text-align: center; display: flex; justify-content: center; align-items: center;">
            <figure>
                <figcaption style="font-size: 40px">⟲</figcaption>
                <img src="media/final_frames/anti-clockwise.jpeg" alt="final_anti_clockwise" style="margin-left: 3%; margin-right: 3%; width: 90%;">
            </figure>
            <figure>
                <figcaption style="font-size: 40px">→</figcaption>
                <img src="media/final_frames/gait.jpeg" alt="final_gait" style="margin-left: 3%; margin-right: 3%; width: 90%;">
            </figure>
            <figure>
                <figcaption style="font-size: 40px">⟳</figcaption>
                <img src="media/final_frames/clockwise.jpeg" alt="final_clockwise" style="margin-left: 3%; margin-right: 3%; width: 90%;">
            </figure>
          </div>
          </div>

        <div style="margin-top: 40px; margin-bottom: 20px;">
            <hr><h2 id="Pre" >Target Following</h2><hr>
            <p style="text-align: justify; font-size: 16px;">
              We consider our CPG-network as a reservoir that encodes many behaviours, which we can learn through ISO.
                The resulting repertoire of motor skills can be used for more complex tasks.
                We provide a feedback signal to our CPG-controller to smoothly switch between skills (see paper for more detail).
                Using, our learned skills (→,⟳,⟲) we are able to successfully complete a random target following task.
            </p>
            <div style="text-align: center; display: flex; justify-content: center; align-items: center; margin-bottom: 4%;">
              <br>
              <video playsinline autoplay muted loop style="width: 80%; border: 0px solid transparent">
                <source src="media/feedback.mp4" type="video/mp4"></source>
              </video>
            </div>
        </div>

        <div style="margin-top: 40px; margin-bottom: 10px;">
            <h2 id="Conclusion">To conclude</h2><hr/>
        <p style="text-align: justify; font-size: 16px;">
            Learning multiple movement skills is an important challenge for legged robotics insofar as it is a prerequisite for viable complex behaviour.
            In this paper, we show that learning can be extremely fast when considering our CPG-network as a reservoir of behaviour from which we can 'select' optimal patterns for several skills.
            Future work will explore how optimisations methods need to look like from this new search paradigm, and we will further investigate the use of <em>bootstrapping</em> and <em>parallelization</em>, leading to a more complex skill learning framework that overall could be applied also to robot in other domains (e.g. soft robots or underwater applications).</p>
        </div>

          <div class="col-md-1"></div>
      </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
    <script>
    MathJax.typesetPromise();
    </script>
    <script src="script.js"></script>
  </body>
</html>

